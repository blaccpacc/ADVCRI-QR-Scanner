<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Scanner with Logo</title>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        #logo {
            width: 100%;
            max-width: 300px;
            height: auto;
            margin: 15px auto;
        }
        #qr-reader {
            display: none;
            width: 100%;
            max-width: 450px;
            height: 250px; /* Consistent height with input boxes */
            margin: auto;
            border: 2px solid #ccc; /* Optional: Adds a border for better visibility */
            border-radius: 8px;
        }
        input, button {
            width: 100%;
            max-width: 450px;
            padding: 12px;
            font-size: 18px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .result-box { padding: 10px; background: #d4edda; border-radius: 8px; }
        button { cursor: pointer; }
        .stop-button { background: #dc3545; color: white; }
    </style>
</head>
<body>
    <img id="logo" src="https://i.imgur.com/yf3hpuu.png" alt="Company Logo">
    <h2>Inventory Scanner</h2>
    <button id="start-scan">Scan QR Code</button>
    <button id="stop-scan" class="stop-button" style="display: none;">ðŸ›‘ Stop Scanning</button>
    <div id="qr-reader"></div>
    <div id="qr-reader-results"></div>
    <input type="text" id="productCode" placeholder="Scanned QR Code" readonly>
    <button onclick="renameCode()">Rename Code</button>
    <button onclick="sendToGoogleSheets()">Save to Google Sheets</button>

    <script>
        let html5QrCode;

        document.getElementById("start-scan").addEventListener("click", function() {
            document.getElementById("qr-reader").style.display = "block";
            document.getElementById("start-scan").style.display = "none";
            document.getElementById("stop-scan").style.display = "inline-block";
            
            html5QrCode = new Html5Qrcode("qr-reader");
            
            html5QrCode.start(
                { facingMode: "environment" }, 
                { fps: 10, qrbox: 250 },
                qrCodeMessage => {
                    document.getElementById("productCode").value = qrCodeMessage;
                },
                errorMessage => {
                    console.log(errorMessage);
                }
            ).catch(err => {
                console.error("Error starting QR code scanner:", err);
            });
        });

        document.getElementById("stop-scan").addEventListener("click", function() {
            html5QrCode.stop().then(() => {
                document.getElementById("qr-reader").style.display = "none";
                document.getElementById("start-scan").style.display = "inline-block";
                document.getElementById("stop-scan").style.display = "none";
            }).catch(err => {
                console.error("Error stopping QR code scanner:", err);
            });
        });

        function renameCode() {
            const newCode = prompt("Enter a new name for the code:", document.getElementById("productCode").value);
            if (newCode) {
                document.getElementById("productCode").value = newCode;
            }
        }

        function sendToGoogleSheets() {
            const qrData = document.getElementById("productCode").value;
            const formUrl = "https://script.google.com/macros/s/AKfycbwVKsq4ysodkdYa6h-kradT9qPTARMAmRMYLHZhkUOOHuRFKih-YXa5ADuDNpzk8dLc2Q/exec";  // The URL of your Google Form
            
            const formData = new FormData();
            formData.append("entry.123456", qrData);  // Replace "entry.123456" with the correct field ID for your form.
            
            fetch(formUrl, {
                method: "POST",
                body: formData,
            })
            .then(response => response.text())
            .then(data => alert("Data saved successfully!"))
            .catch(error => alert("Error saving data: " + error));
        }
    </script>
</body>
</html>
